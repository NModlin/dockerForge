"use strict";(self["webpackChunkdockerforge_web_ui"]=self["webpackChunkdockerforge_web_ui"]||[]).push([[577],{4577:function(e,t,l){l.r(t),l.d(t,{default:function(){return k}});var a=l(641),o=l(33);const s={class:"compose-detail"},n={key:0,class:"d-flex justify-center align-center my-5"},i={key:0},r={key:1};function c(e,t,l,c,d,u){const p=(0,a.g2)("v-icon"),m=(0,a.g2)("v-btn"),k=(0,a.g2)("v-col"),g=(0,a.g2)("v-row"),b=(0,a.g2)("v-progress-circular"),f=(0,a.g2)("v-alert"),_=(0,a.g2)("v-chip"),h=(0,a.g2)("v-spacer"),v=(0,a.g2)("v-btn-toggle"),F=(0,a.g2)("v-card-title"),C=(0,a.g2)("v-simple-table"),y=(0,a.g2)("v-card-text"),j=(0,a.g2)("v-card"),W=(0,a.g2)("router-link"),w=(0,a.g2)("v-data-table"),D=(0,a.g2)("v-sheet"),x=(0,a.g2)("v-checkbox"),S=(0,a.g2)("v-card-actions"),L=(0,a.g2)("v-dialog"),V=(0,a.g2)("v-textarea");return(0,a.uX)(),(0,a.CE)("div",s,[(0,a.bF)(g,null,{default:(0,a.k6)((()=>[(0,a.bF)(k,{cols:"12"},{default:(0,a.k6)((()=>[(0,a.bF)(m,{text:"",to:"/compose",class:"mb-4"},{default:(0,a.k6)((()=>[(0,a.bF)(p,{left:""},{default:(0,a.k6)((()=>t[11]||(t[11]=[(0,a.eW)("mdi-arrow-left")]))),_:1}),t[12]||(t[12]=(0,a.eW)(" Back to Compose Projects "))])),_:1})])),_:1})])),_:1}),d.loading?((0,a.uX)(),(0,a.CE)("div",n,[(0,a.bF)(b,{indeterminate:"",color:"primary"})])):d.error?((0,a.uX)(),(0,a.Wv)(f,{key:1,type:"error",class:"mb-4"},{default:(0,a.k6)((()=>[(0,a.eW)((0,o.v_)(d.error),1)])),_:1})):d.project?((0,a.uX)(),(0,a.CE)(a.FK,{key:3},[(0,a.bF)(g,null,{default:(0,a.k6)((()=>[(0,a.bF)(k,{cols:"12"},{default:(0,a.k6)((()=>[(0,a.bF)(j,{class:"mb-4"},{default:(0,a.k6)((()=>[(0,a.bF)(F,{class:"headline d-flex align-center"},{default:(0,a.k6)((()=>[(0,a.eW)((0,o.v_)(d.project.name)+" ",1),(0,a.bF)(_,{class:"ml-2",color:u.getStatusColor(d.project.status),"text-color":"white",small:""},{default:(0,a.k6)((()=>[(0,a.eW)((0,o.v_)(d.project.status),1)])),_:1},8,["color"]),(0,a.bF)(h),(0,a.bF)(v,null,{default:(0,a.k6)((()=>[(0,a.bF)(m,{disabled:"running"===d.project.status,onClick:u.startProject,color:"success",text:""},{default:(0,a.k6)((()=>[(0,a.bF)(p,{left:""},{default:(0,a.k6)((()=>t[14]||(t[14]=[(0,a.eW)("mdi-play")]))),_:1}),t[15]||(t[15]=(0,a.eW)(" Start "))])),_:1},8,["disabled","onClick"]),(0,a.bF)(m,{disabled:"running"!==d.project.status,onClick:u.stopProject,color:"error",text:""},{default:(0,a.k6)((()=>[(0,a.bF)(p,{left:""},{default:(0,a.k6)((()=>t[16]||(t[16]=[(0,a.eW)("mdi-stop")]))),_:1}),t[17]||(t[17]=(0,a.eW)(" Stop "))])),_:1},8,["disabled","onClick"]),(0,a.bF)(m,{disabled:"running"!==d.project.status,onClick:u.restartProject,color:"primary",text:""},{default:(0,a.k6)((()=>[(0,a.bF)(p,{left:""},{default:(0,a.k6)((()=>t[18]||(t[18]=[(0,a.eW)("mdi-restart")]))),_:1}),t[19]||(t[19]=(0,a.eW)(" Restart "))])),_:1},8,["disabled","onClick"]),(0,a.bF)(m,{onClick:u.showDeleteDialog,color:"error",text:""},{default:(0,a.k6)((()=>[(0,a.bF)(p,{left:""},{default:(0,a.k6)((()=>t[20]||(t[20]=[(0,a.eW)("mdi-delete")]))),_:1}),t[21]||(t[21]=(0,a.eW)(" Delete "))])),_:1},8,["onClick"])])),_:1})])),_:1}),(0,a.bF)(y,null,{default:(0,a.k6)((()=>[(0,a.bF)(C,null,{default:(0,a.k6)((()=>[(0,a.Lk)("tbody",null,[(0,a.Lk)("tr",null,[t[22]||(t[22]=(0,a.Lk)("td",{class:"font-weight-bold"},"ID",-1)),(0,a.Lk)("td",null,(0,o.v_)(d.project.id),1)]),(0,a.Lk)("tr",null,[t[23]||(t[23]=(0,a.Lk)("td",{class:"font-weight-bold"},"Location",-1)),(0,a.Lk)("td",null,(0,o.v_)(d.project.location),1)]),(0,a.Lk)("tr",null,[t[24]||(t[24]=(0,a.Lk)("td",{class:"font-weight-bold"},"Services",-1)),(0,a.Lk)("td",null,(0,o.v_)(d.project.service_count),1)]),(0,a.Lk)("tr",null,[t[25]||(t[25]=(0,a.Lk)("td",{class:"font-weight-bold"},"Created",-1)),(0,a.Lk)("td",null,(0,o.v_)(u.formatDate(d.project.created_at)),1)]),d.project.last_deployed?((0,a.uX)(),(0,a.CE)("tr",i,[t[26]||(t[26]=(0,a.Lk)("td",{class:"font-weight-bold"},"Last Deployed",-1)),(0,a.Lk)("td",null,(0,o.v_)(u.formatDate(d.project.last_deployed)),1)])):(0,a.Q3)("",!0)])])),_:1})])),_:1})])),_:1})])),_:1})])),_:1}),(0,a.bF)(g,null,{default:(0,a.k6)((()=>[(0,a.bF)(k,{cols:"12"},{default:(0,a.k6)((()=>[t[31]||(t[31]=(0,a.Lk)("h2",{class:"text-h5 mb-3"},"Services",-1)),(0,a.bF)(j,null,{default:(0,a.k6)((()=>[(0,a.bF)(w,{headers:d.serviceHeaders,items:d.services,"items-per-page":10,class:"elevation-1"},{"item.name":(0,a.k6)((({item:e})=>[e.container_id?((0,a.uX)(),(0,a.Wv)(W,{key:0,to:`/containers/${e.container_id}`,class:"text-decoration-none"},{default:(0,a.k6)((()=>[(0,a.eW)((0,o.v_)(e.name),1)])),_:2},1032,["to"])):((0,a.uX)(),(0,a.CE)("span",r,(0,o.v_)(e.name),1))])),"item.status":(0,a.k6)((({item:e})=>[(0,a.bF)(_,{color:u.getStatusColor(e.status),"text-color":"white",small:""},{default:(0,a.k6)((()=>[(0,a.eW)((0,o.v_)(e.status),1)])),_:2},1032,["color"])])),"item.actions":(0,a.k6)((({item:e})=>[(0,a.bF)(m,{icon:"",small:"",disabled:"running"===e.status,onClick:t=>u.startService(e),title:"Start"},{default:(0,a.k6)((()=>[(0,a.bF)(p,{small:""},{default:(0,a.k6)((()=>t[27]||(t[27]=[(0,a.eW)("mdi-play")]))),_:1})])),_:2},1032,["disabled","onClick"]),(0,a.bF)(m,{icon:"",small:"",disabled:"running"!==e.status,onClick:t=>u.stopService(e),title:"Stop"},{default:(0,a.k6)((()=>[(0,a.bF)(p,{small:""},{default:(0,a.k6)((()=>t[28]||(t[28]=[(0,a.eW)("mdi-stop")]))),_:1})])),_:2},1032,["disabled","onClick"]),(0,a.bF)(m,{icon:"",small:"",disabled:"running"!==e.status,onClick:t=>u.restartService(e),title:"Restart"},{default:(0,a.k6)((()=>[(0,a.bF)(p,{small:""},{default:(0,a.k6)((()=>t[29]||(t[29]=[(0,a.eW)("mdi-restart")]))),_:1})])),_:2},1032,["disabled","onClick"]),(0,a.bF)(m,{icon:"",small:"",disabled:!e.logs_available,onClick:t=>u.viewLogs(e),title:"View Logs"},{default:(0,a.k6)((()=>[(0,a.bF)(p,{small:""},{default:(0,a.k6)((()=>t[30]||(t[30]=[(0,a.eW)("mdi-text-box-outline")]))),_:1})])),_:2},1032,["disabled","onClick"])])),_:1},8,["headers","items"])])),_:1})])),_:1})])),_:1}),(0,a.bF)(g,{class:"mt-4"},{default:(0,a.k6)((()=>[(0,a.bF)(k,{cols:"12"},{default:(0,a.k6)((()=>[t[35]||(t[35]=(0,a.Lk)("h2",{class:"text-h5 mb-3"},"Compose File",-1)),(0,a.bF)(j,null,{default:(0,a.k6)((()=>[(0,a.bF)(F,{class:"d-flex align-center"},{default:(0,a.k6)((()=>[t[34]||(t[34]=(0,a.Lk)("span",null,"docker-compose.yml",-1)),(0,a.bF)(h),(0,a.bF)(m,{color:"primary",text:"",onClick:u.editComposeFile},{default:(0,a.k6)((()=>[(0,a.bF)(p,{left:""},{default:(0,a.k6)((()=>t[32]||(t[32]=[(0,a.eW)("mdi-pencil")]))),_:1}),t[33]||(t[33]=(0,a.eW)(" Edit "))])),_:1},8,["onClick"])])),_:1}),(0,a.bF)(y,null,{default:(0,a.k6)((()=>[(0,a.bF)(D,{class:"pa-4 compose-file-content",outlined:"",rounded:""},{default:(0,a.k6)((()=>[(0,a.Lk)("pre",null,(0,o.v_)(d.composeFileContent),1)])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})],64)):((0,a.uX)(),(0,a.Wv)(f,{key:2,type:"warning",class:"mb-4"},{default:(0,a.k6)((()=>t[13]||(t[13]=[(0,a.eW)(" Compose project not found ")]))),_:1})),(0,a.bF)(L,{modelValue:d.deleteDialog,"onUpdate:modelValue":t[2]||(t[2]=e=>d.deleteDialog=e),"max-width":"500"},{default:(0,a.k6)((()=>[(0,a.bF)(j,null,{default:(0,a.k6)((()=>[(0,a.bF)(F,{class:"headline"},{default:(0,a.k6)((()=>t[36]||(t[36]=[(0,a.eW)("Delete Compose Project")]))),_:1}),(0,a.bF)(y,null,{default:(0,a.k6)((()=>[t[37]||(t[37]=(0,a.eW)(" Are you sure you want to delete the compose project ")),(0,a.Lk)("strong",null,(0,o.v_)(d.project?.name),1),t[38]||(t[38]=(0,a.eW)("? ")),(0,a.bF)(x,{modelValue:d.deleteWithVolumes,"onUpdate:modelValue":t[0]||(t[0]=e=>d.deleteWithVolumes=e),label:"Also remove associated volumes",class:"mt-4"},null,8,["modelValue"])])),_:1}),(0,a.bF)(S,null,{default:(0,a.k6)((()=>[(0,a.bF)(h),(0,a.bF)(m,{color:"grey darken-1",text:"",onClick:t[1]||(t[1]=e=>d.deleteDialog=!1)},{default:(0,a.k6)((()=>t[39]||(t[39]=[(0,a.eW)(" Cancel ")]))),_:1}),(0,a.bF)(m,{color:"red darken-1",text:"",onClick:u.deleteProject},{default:(0,a.k6)((()=>t[40]||(t[40]=[(0,a.eW)(" Delete ")]))),_:1},8,["onClick"])])),_:1})])),_:1})])),_:1},8,["modelValue"]),(0,a.bF)(L,{modelValue:d.logsDialog,"onUpdate:modelValue":t[6]||(t[6]=e=>d.logsDialog=e),"max-width":"800"},{default:(0,a.k6)((()=>[(0,a.bF)(j,null,{default:(0,a.k6)((()=>[(0,a.bF)(F,{class:"headline"},{default:(0,a.k6)((()=>[(0,a.eW)(" Logs: "+(0,o.v_)(d.selectedService?.name)+" ",1),(0,a.bF)(h),(0,a.bF)(m,{icon:"",onClick:t[3]||(t[3]=e=>d.logsDialog=!1)},{default:(0,a.k6)((()=>[(0,a.bF)(p,null,{default:(0,a.k6)((()=>t[41]||(t[41]=[(0,a.eW)("mdi-close")]))),_:1})])),_:1})])),_:1}),(0,a.bF)(y,null,{default:(0,a.k6)((()=>[(0,a.bF)(x,{modelValue:d.followLogs,"onUpdate:modelValue":t[4]||(t[4]=e=>d.followLogs=e),label:"Follow logs",class:"mb-2"},null,8,["modelValue"]),(0,a.bF)(D,{class:"pa-4 logs-content",outlined:"",rounded:"",height:"400px",style:{"overflow-y":"auto","font-family":"monospace"}},{default:(0,a.k6)((()=>[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(d.serviceLogs,((e,t)=>((0,a.uX)(),(0,a.CE)("div",{key:t},(0,o.v_)(e),1)))),128))])),_:1})])),_:1}),(0,a.bF)(S,null,{default:(0,a.k6)((()=>[(0,a.bF)(h),(0,a.bF)(m,{color:"primary",text:"",onClick:t[5]||(t[5]=e=>d.logsDialog=!1)},{default:(0,a.k6)((()=>t[42]||(t[42]=[(0,a.eW)(" Close ")]))),_:1})])),_:1})])),_:1})])),_:1},8,["modelValue"]),(0,a.bF)(L,{modelValue:d.editDialog,"onUpdate:modelValue":t[10]||(t[10]=e=>d.editDialog=e),"max-width":"800"},{default:(0,a.k6)((()=>[(0,a.bF)(j,null,{default:(0,a.k6)((()=>[(0,a.bF)(F,{class:"headline"},{default:(0,a.k6)((()=>[t[44]||(t[44]=(0,a.eW)(" Edit Compose File ")),(0,a.bF)(h),(0,a.bF)(m,{icon:"",onClick:t[7]||(t[7]=e=>d.editDialog=!1)},{default:(0,a.k6)((()=>[(0,a.bF)(p,null,{default:(0,a.k6)((()=>t[43]||(t[43]=[(0,a.eW)("mdi-close")]))),_:1})])),_:1})])),_:1}),(0,a.bF)(y,null,{default:(0,a.k6)((()=>[(0,a.bF)(V,{modelValue:d.editedComposeFile,"onUpdate:modelValue":t[8]||(t[8]=e=>d.editedComposeFile=e),outlined:"",rows:"20",class:"font-family-monospace"},null,8,["modelValue"])])),_:1}),(0,a.bF)(S,null,{default:(0,a.k6)((()=>[(0,a.bF)(h),(0,a.bF)(m,{color:"grey darken-1",text:"",onClick:t[9]||(t[9]=e=>d.editDialog=!1)},{default:(0,a.k6)((()=>t[45]||(t[45]=[(0,a.eW)(" Cancel ")]))),_:1}),(0,a.bF)(m,{color:"primary",text:"",onClick:u.saveComposeFile},{default:(0,a.k6)((()=>t[46]||(t[46]=[(0,a.eW)(" Save ")]))),_:1},8,["onClick"])])),_:1})])),_:1})])),_:1},8,["modelValue"])])}var d=l(2977),u={name:"ComposeDetail",data(){return{loading:!0,error:null,project:null,services:[],composeFileContent:"",serviceHeaders:[{text:"Name",value:"name",sortable:!0},{text:"Status",value:"status",sortable:!0},{text:"Image",value:"image",sortable:!0},{text:"Ports",value:"ports",sortable:!1},{text:"Actions",value:"actions",sortable:!1,align:"center"}],deleteDialog:!1,deleteWithVolumes:!1,logsDialog:!1,selectedService:null,serviceLogs:[],followLogs:!1,editDialog:!1,editedComposeFile:""}},computed:{...(0,d.L8)({isAuthenticated:"auth/isAuthenticated",token:"auth/token"})},created(){this.fetchProjectDetails()},methods:{async fetchProjectDetails(){this.loading=!0,this.error=null;try{setTimeout((()=>{this.project={id:this.$route.params.id,name:"web-app",status:"running",service_count:3,location:"/home/user/projects/web-app",created_at:"2025-03-15T10:00:00Z",last_deployed:"2025-03-16T08:30:00Z"},this.services=[{name:"web",status:"running",image:"nginx:latest",ports:["80:80","443:443"],container_id:"c1",logs_available:!0},{name:"api",status:"running",image:"node:14-alpine",ports:["3000:3000"],container_id:"c4",logs_available:!0},{name:"db",status:"running",image:"postgres:13",ports:["5432:5432"],container_id:"c3",logs_available:!0}],this.composeFileContent='version: \'3\'\n\nservices:\n  web:\n    image: nginx:latest\n    ports:\n      - "80:80"\n      - "443:443"\n    volumes:\n      - ./nginx/conf:/etc/nginx/conf.d\n    depends_on:\n      - api\n    restart: always\n\n  api:\n    image: node:14-alpine\n    working_dir: /app\n    volumes:\n      - ./api:/app\n    command: npm start\n    ports:\n      - "3000:3000"\n    environment:\n      - NODE_ENV=production\n      - DB_HOST=db\n    depends_on:\n      - db\n    restart: always\n\n  db:\n    image: postgres:13\n    volumes:\n      - postgres_data:/var/lib/postgresql/data\n    environment:\n      - POSTGRES_PASSWORD=example\n      - POSTGRES_USER=app\n      - POSTGRES_DB=app_db\n    ports:\n      - "5432:5432"\n    restart: always\n\nvolumes:\n  postgres_data:',this.loading=!1}),1e3)}catch(e){this.error="Failed to load compose project details. Please try again.",this.loading=!1}},formatDate(e){const t=new Date(e);return t.toLocaleString()},getStatusColor(e){switch(e){case"running":return"success";case"stopped":return"error";case"partial":return"warning";default:return"grey"}},async startProject(){try{this.project.status="running",this.services.forEach((e=>{e.status="running"}))}catch(e){this.error=`Failed to start compose project ${this.project.name}`}},async stopProject(){try{this.project.status="stopped",this.services.forEach((e=>{e.status="stopped"}))}catch(e){this.error=`Failed to stop compose project ${this.project.name}`}},async restartProject(){try{this.project.status="running",this.services.forEach((e=>{e.status="running"}))}catch(e){this.error=`Failed to restart compose project ${this.project.name}`}},showDeleteDialog(){this.deleteWithVolumes=!1,this.deleteDialog=!0},async deleteProject(){try{this.$router.push("/compose")}catch(e){this.error=`Failed to delete compose project ${this.project.name}`,this.deleteDialog=!1}},async startService(e){try{e.status="running",this.updateProjectStatus()}catch(t){this.error=`Failed to start service ${e.name}`}},async stopService(e){try{e.status="stopped",this.updateProjectStatus()}catch(t){this.error=`Failed to stop service ${e.name}`}},async restartService(e){try{e.status="running",this.updateProjectStatus()}catch(t){this.error=`Failed to restart service ${e.name}`}},updateProjectStatus(){const e=this.services.filter((e=>"running"===e.status)).length;0===e?this.project.status="stopped":e===this.services.length?this.project.status="running":this.project.status="partial"},viewLogs(e){this.selectedService=e,this.serviceLogs=[`[2025-03-16 08:30:01] ${e.name} | Starting ${e.name} service...`,`[2025-03-16 08:30:02] ${e.name} | Service started successfully`,`[2025-03-16 08:30:03] ${e.name} | Listening on port ${e.ports[0].split(":")[0]}`,`[2025-03-16 08:35:15] ${e.name} | Received request from 192.168.1.5`,`[2025-03-16 08:35:16] ${e.name} | Request processed successfully (200 OK)`,`[2025-03-16 08:40:22] ${e.name} | Received request from 192.168.1.10`,`[2025-03-16 08:40:23] ${e.name} | Request processed successfully (200 OK)`,`[2025-03-16 08:45:30] ${e.name} | Performing scheduled health check`,`[2025-03-16 08:45:31] ${e.name} | Health check passed: all systems operational`],this.logsDialog=!0},editComposeFile(){this.editedComposeFile=this.composeFileContent,this.editDialog=!0},async saveComposeFile(){try{this.composeFileContent=this.editedComposeFile,this.editDialog=!1}catch(e){this.error="Failed to save compose file"}}}},p=l(6262);const m=(0,p.A)(u,[["render",c],["__scopeId","data-v-ff2e4fd2"]]);var k=m}}]);