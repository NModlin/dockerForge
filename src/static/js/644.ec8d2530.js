"use strict";(self["webpackChunkdockerforge_web_ui"]=self["webpackChunkdockerforge_web_ui"]||[]).push([[644],{3644:function(e,t,l){l.r(t),l.d(t,{default:function(){return p}});var a=l(641),i=l(33);const r={class:"image-security"},s={class:"text-h4"},n={class:"text-h4"},u={class:"text-h4 black--text"},c={class:"text-h4"},d={key:0},o={key:1},k={key:0},b={key:1};function _(e,t,l,_,f,v){const m=(0,a.g2)("v-icon"),h=(0,a.g2)("v-spacer"),F=(0,a.g2)("v-btn"),g=(0,a.g2)("v-card-title"),y=(0,a.g2)("v-skeleton-loader"),p=(0,a.g2)("v-card-text"),x=(0,a.g2)("v-alert"),w=(0,a.g2)("v-list-item-title"),S=(0,a.g2)("v-list-item-subtitle"),V=(0,a.g2)("v-list-item-content"),C=(0,a.g2)("v-list-item"),W=(0,a.g2)("v-chip"),I=(0,a.g2)("v-list"),L=(0,a.g2)("v-col"),A=(0,a.g2)("v-row"),D=(0,a.g2)("v-card"),E=(0,a.g2)("v-divider"),X=(0,a.g2)("v-text-field"),T=(0,a.g2)("v-select"),N=(0,a.g2)("v-data-table"),H=(0,a.g2)("v-container"),M=(0,a.g2)("v-card-actions"),R=(0,a.g2)("v-dialog"),U=(0,a.g2)("v-snackbar");return(0,a.uX)(),(0,a.CE)("div",r,[(0,a.bF)(H,{fluid:""},{default:(0,a.k6)((()=>[(0,a.bF)(A,null,{default:(0,a.k6)((()=>[(0,a.bF)(L,{cols:"12"},{default:(0,a.k6)((()=>[(0,a.bF)(D,null,{default:(0,a.k6)((()=>[(0,a.bF)(g,{class:"headline"},{default:(0,a.k6)((()=>[(0,a.bF)(m,{large:"",left:""},{default:(0,a.k6)((()=>t[7]||(t[7]=[(0,a.eW)("mdi-shield-search")]))),_:1}),t[10]||(t[10]=(0,a.eW)(" Security Scan Results ")),(0,a.bF)(h),(0,a.bF)(F,{color:"primary",onClick:v.goBack},{default:(0,a.k6)((()=>[(0,a.bF)(m,{left:""},{default:(0,a.k6)((()=>t[8]||(t[8]=[(0,a.eW)("mdi-arrow-left")]))),_:1}),t[9]||(t[9]=(0,a.eW)(" Back to Image "))])),_:1},8,["onClick"])])),_:1}),f.loading?((0,a.uX)(),(0,a.Wv)(p,{key:0},{default:(0,a.k6)((()=>[(0,a.bF)(y,{type:"article"})])),_:1})):e.currentScan?((0,a.uX)(),(0,a.CE)(a.FK,{key:2},[(0,a.bF)(p,null,{default:(0,a.k6)((()=>[(0,a.bF)(A,null,{default:(0,a.k6)((()=>[(0,a.bF)(L,{cols:"12",md:"6"},{default:(0,a.k6)((()=>[(0,a.bF)(I,{dense:""},{default:(0,a.k6)((()=>[(0,a.bF)(C,null,{default:(0,a.k6)((()=>[(0,a.bF)(V,null,{default:(0,a.k6)((()=>[(0,a.bF)(w,null,{default:(0,a.k6)((()=>t[12]||(t[12]=[(0,a.eW)("Scan ID")]))),_:1}),(0,a.bF)(S,null,{default:(0,a.k6)((()=>[(0,a.eW)((0,i.v_)(e.currentScan.scan.id),1)])),_:1})])),_:1})])),_:1}),(0,a.bF)(C,null,{default:(0,a.k6)((()=>[(0,a.bF)(V,null,{default:(0,a.k6)((()=>[(0,a.bF)(w,null,{default:(0,a.k6)((()=>t[13]||(t[13]=[(0,a.eW)("Scan Type")]))),_:1}),(0,a.bF)(S,null,{default:(0,a.k6)((()=>[(0,a.eW)((0,i.v_)(e.currentScan.scan.scan_type),1)])),_:1})])),_:1})])),_:1}),(0,a.bF)(C,null,{default:(0,a.k6)((()=>[(0,a.bF)(V,null,{default:(0,a.k6)((()=>[(0,a.bF)(w,null,{default:(0,a.k6)((()=>t[14]||(t[14]=[(0,a.eW)("Status")]))),_:1}),(0,a.bF)(S,null,{default:(0,a.k6)((()=>[(0,a.bF)(W,{small:"",color:v.getScanStatusColor(e.currentScan.scan.status),"text-color":"white"},{default:(0,a.k6)((()=>[(0,a.eW)((0,i.v_)(e.currentScan.scan.status),1)])),_:1},8,["color"])])),_:1})])),_:1})])),_:1})])),_:1})])),_:1}),(0,a.bF)(L,{cols:"12",md:"6"},{default:(0,a.k6)((()=>[(0,a.bF)(I,{dense:""},{default:(0,a.k6)((()=>[(0,a.bF)(C,null,{default:(0,a.k6)((()=>[(0,a.bF)(V,null,{default:(0,a.k6)((()=>[(0,a.bF)(w,null,{default:(0,a.k6)((()=>t[15]||(t[15]=[(0,a.eW)("Started")]))),_:1}),(0,a.bF)(S,null,{default:(0,a.k6)((()=>[(0,a.eW)((0,i.v_)(v.formatDate(e.currentScan.scan.started_at)),1)])),_:1})])),_:1})])),_:1}),(0,a.bF)(C,null,{default:(0,a.k6)((()=>[(0,a.bF)(V,null,{default:(0,a.k6)((()=>[(0,a.bF)(w,null,{default:(0,a.k6)((()=>t[16]||(t[16]=[(0,a.eW)("Completed")]))),_:1}),(0,a.bF)(S,null,{default:(0,a.k6)((()=>[(0,a.eW)((0,i.v_)(v.formatDate(e.currentScan.scan.completed_at)),1)])),_:1})])),_:1})])),_:1}),(0,a.bF)(C,null,{default:(0,a.k6)((()=>[(0,a.bF)(V,null,{default:(0,a.k6)((()=>[(0,a.bF)(w,null,{default:(0,a.k6)((()=>t[17]||(t[17]=[(0,a.eW)("Total Vulnerabilities")]))),_:1}),(0,a.bF)(S,null,{default:(0,a.k6)((()=>[(0,a.eW)((0,i.v_)(e.currentScan.scan.vulnerabilities_count||0),1)])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})])),_:1}),(0,a.bF)(A,{class:"mt-4"},{default:(0,a.k6)((()=>[(0,a.bF)(L,{cols:"12"},{default:(0,a.k6)((()=>[(0,a.bF)(D,{outlined:""},{default:(0,a.k6)((()=>[(0,a.bF)(g,null,{default:(0,a.k6)((()=>t[18]||(t[18]=[(0,a.eW)("Vulnerability Summary")]))),_:1}),(0,a.bF)(p,null,{default:(0,a.k6)((()=>[(0,a.bF)(A,null,{default:(0,a.k6)((()=>[(0,a.bF)(L,{cols:"12",sm:"6",md:"3"},{default:(0,a.k6)((()=>[(0,a.bF)(D,{color:"red",dark:""},{default:(0,a.k6)((()=>[(0,a.bF)(p,{class:"text-center"},{default:(0,a.k6)((()=>[(0,a.Lk)("div",s,(0,i.v_)(e.currentScan.scan.critical_count||0),1),t[19]||(t[19]=(0,a.Lk)("div",null,"Critical",-1))])),_:1})])),_:1})])),_:1}),(0,a.bF)(L,{cols:"12",sm:"6",md:"3"},{default:(0,a.k6)((()=>[(0,a.bF)(D,{color:"orange",dark:""},{default:(0,a.k6)((()=>[(0,a.bF)(p,{class:"text-center"},{default:(0,a.k6)((()=>[(0,a.Lk)("div",n,(0,i.v_)(e.currentScan.scan.high_count||0),1),t[20]||(t[20]=(0,a.Lk)("div",null,"High",-1))])),_:1})])),_:1})])),_:1}),(0,a.bF)(L,{cols:"12",sm:"6",md:"3"},{default:(0,a.k6)((()=>[(0,a.bF)(D,{color:"yellow",dark:""},{default:(0,a.k6)((()=>[(0,a.bF)(p,{class:"text-center"},{default:(0,a.k6)((()=>[(0,a.Lk)("div",u,(0,i.v_)(e.currentScan.scan.medium_count||0),1),t[21]||(t[21]=(0,a.Lk)("div",{class:"black--text"},"Medium",-1))])),_:1})])),_:1})])),_:1}),(0,a.bF)(L,{cols:"12",sm:"6",md:"3"},{default:(0,a.k6)((()=>[(0,a.bF)(D,{color:"blue",dark:""},{default:(0,a.k6)((()=>[(0,a.bF)(p,{class:"text-center"},{default:(0,a.k6)((()=>[(0,a.Lk)("div",c,(0,i.v_)(e.currentScan.scan.low_count||0),1),t[22]||(t[22]=(0,a.Lk)("div",null,"Low",-1))])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})])),_:1}),(0,a.bF)(E),(0,a.bF)(g,null,{default:(0,a.k6)((()=>[t[23]||(t[23]=(0,a.eW)(" Vulnerabilities ")),(0,a.bF)(h),(0,a.bF)(X,{modelValue:f.search,"onUpdate:modelValue":t[0]||(t[0]=e=>f.search=e),"append-icon":"mdi-magnify",label:"Search","single-line":"","hide-details":"",class:"mx-4"},null,8,["modelValue"]),(0,a.bF)(T,{modelValue:f.severityFilter,"onUpdate:modelValue":t[1]||(t[1]=e=>f.severityFilter=e),items:f.severityOptions,label:"Severity","hide-details":"",class:"mx-4",style:{"max-width":"150px"}},null,8,["modelValue","items"])])),_:1}),(0,a.bF)(N,{headers:f.headers,items:v.filteredVulnerabilities,search:f.search,"items-per-page":10,"footer-props":{"items-per-page-options":[5,10,15,20,50]},class:"elevation-1"},{"item.severity":(0,a.k6)((({item:e})=>[(0,a.bF)(W,{small:"",color:v.getSeverityColor(e.severity),"text-color":"medium"===e.severity?"black":"white"},{default:(0,a.k6)((()=>[(0,a.eW)((0,i.v_)(e.severity),1)])),_:2},1032,["color","text-color"])])),"item.reference_urls":(0,a.k6)((({item:e})=>[e.reference_urls&&e.reference_urls.length>0?((0,a.uX)(),(0,a.CE)("div",d,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(e.reference_urls,((e,l)=>((0,a.uX)(),(0,a.Wv)(F,{key:l,"x-small":"",text:"",color:"primary",href:e,target:"_blank",class:"mr-1"},{default:(0,a.k6)((()=>[(0,a.bF)(m,{"x-small":"",left:""},{default:(0,a.k6)((()=>t[24]||(t[24]=[(0,a.eW)("mdi-open-in-new")]))),_:1}),(0,a.eW)(" Link "+(0,i.v_)(l+1),1)])),_:2},1032,["href"])))),128))])):((0,a.uX)(),(0,a.CE)("span",o,"-"))])),"item.actions":(0,a.k6)((({item:e})=>[(0,a.bF)(F,{icon:"",small:"",onClick:t=>v.showVulnerabilityDetails(e)},{default:(0,a.k6)((()=>[(0,a.bF)(m,{small:""},{default:(0,a.k6)((()=>t[25]||(t[25]=[(0,a.eW)("mdi-information-outline")]))),_:1})])),_:2},1032,["onClick"])])),_:1},8,["headers","items","search"])],64)):((0,a.uX)(),(0,a.Wv)(p,{key:1},{default:(0,a.k6)((()=>[(0,a.bF)(x,{type:"error"},{default:(0,a.k6)((()=>t[11]||(t[11]=[(0,a.eW)("Scan not found")]))),_:1})])),_:1}))])),_:1})])),_:1})])),_:1})])),_:1}),(0,a.bF)(R,{modelValue:f.detailsDialog,"onUpdate:modelValue":t[4]||(t[4]=e=>f.detailsDialog=e),"max-width":"700px"},{default:(0,a.k6)((()=>[f.selectedVulnerability?((0,a.uX)(),(0,a.Wv)(D,{key:0},{default:(0,a.k6)((()=>[(0,a.bF)(g,{class:"headline"},{default:(0,a.k6)((()=>[(0,a.bF)(W,{small:"",color:v.getSeverityColor(f.selectedVulnerability.severity),"text-color":"medium"===f.selectedVulnerability.severity?"black":"white",class:"mr-2"},{default:(0,a.k6)((()=>[(0,a.eW)((0,i.v_)(f.selectedVulnerability.severity),1)])),_:1},8,["color","text-color"]),(0,a.eW)(" "+(0,i.v_)(f.selectedVulnerability.name),1)])),_:1}),(0,a.bF)(p,null,{default:(0,a.k6)((()=>[(0,a.bF)(A,null,{default:(0,a.k6)((()=>[(0,a.bF)(L,{cols:"12"},{default:(0,a.k6)((()=>[t[26]||(t[26]=(0,a.Lk)("div",{class:"subtitle-1 font-weight-bold"},"Description",-1)),(0,a.Lk)("div",null,(0,i.v_)(f.selectedVulnerability.description),1)])),_:1}),(0,a.bF)(L,{cols:"12",sm:"6"},{default:(0,a.k6)((()=>[t[27]||(t[27]=(0,a.Lk)("div",{class:"subtitle-1 font-weight-bold"},"Package",-1)),(0,a.Lk)("div",null,(0,i.v_)(f.selectedVulnerability.package_name||"N/A"),1)])),_:1}),(0,a.bF)(L,{cols:"12",sm:"6"},{default:(0,a.k6)((()=>[t[28]||(t[28]=(0,a.Lk)("div",{class:"subtitle-1 font-weight-bold"},"Current Version",-1)),(0,a.Lk)("div",null,(0,i.v_)(f.selectedVulnerability.package_version||"N/A"),1)])),_:1}),(0,a.bF)(L,{cols:"12",sm:"6"},{default:(0,a.k6)((()=>[t[29]||(t[29]=(0,a.Lk)("div",{class:"subtitle-1 font-weight-bold"},"Fixed Version",-1)),(0,a.Lk)("div",null,(0,i.v_)(f.selectedVulnerability.fixed_version||"N/A"),1)])),_:1}),(0,a.bF)(L,{cols:"12",sm:"6"},{default:(0,a.k6)((()=>[t[30]||(t[30]=(0,a.Lk)("div",{class:"subtitle-1 font-weight-bold"},"CVE ID",-1)),(0,a.Lk)("div",null,(0,i.v_)(f.selectedVulnerability.cve_id||"N/A"),1)])),_:1}),(0,a.bF)(L,{cols:"12"},{default:(0,a.k6)((()=>[t[32]||(t[32]=(0,a.Lk)("div",{class:"subtitle-1 font-weight-bold"},"References",-1)),f.selectedVulnerability.reference_urls&&f.selectedVulnerability.reference_urls.length>0?((0,a.uX)(),(0,a.CE)("div",k,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(f.selectedVulnerability.reference_urls,((e,l)=>((0,a.uX)(),(0,a.Wv)(F,{key:l,small:"",text:"",color:"primary",href:e,target:"_blank",class:"mr-1 mb-1"},{default:(0,a.k6)((()=>[(0,a.bF)(m,{small:"",left:""},{default:(0,a.k6)((()=>t[31]||(t[31]=[(0,a.eW)("mdi-open-in-new")]))),_:1}),(0,a.eW)(" Reference "+(0,i.v_)(l+1),1)])),_:2},1032,["href"])))),128))])):((0,a.uX)(),(0,a.CE)("div",b,"No references available"))])),_:1})])),_:1})])),_:1}),(0,a.bF)(M,null,{default:(0,a.k6)((()=>[(0,a.bF)(F,{color:"info",text:"",onClick:t[2]||(t[2]=e=>v.resolveWithAI(f.selectedVulnerability)),disabled:!f.selectedVulnerability.fixed_version},{default:(0,a.k6)((()=>[(0,a.bF)(m,{left:""},{default:(0,a.k6)((()=>t[33]||(t[33]=[(0,a.eW)("mdi-robot")]))),_:1}),t[34]||(t[34]=(0,a.eW)(" Resolve with AI "))])),_:1},8,["disabled"]),(0,a.bF)(h),(0,a.bF)(F,{color:"primary",text:"",onClick:t[3]||(t[3]=e=>f.detailsDialog=!1)},{default:(0,a.k6)((()=>t[35]||(t[35]=[(0,a.eW)("Close")]))),_:1})])),_:1})])),_:1})):(0,a.Q3)("",!0)])),_:1},8,["modelValue"]),(0,a.bF)(U,{modelValue:f.snackbar,"onUpdate:modelValue":t[6]||(t[6]=e=>f.snackbar=e),color:f.snackbarColor,timeout:3e3},{action:(0,a.k6)((({attrs:e})=>[(0,a.bF)(F,(0,a.v6)({text:""},e,{onClick:t[5]||(t[5]=e=>f.snackbar=!1)}),{default:(0,a.k6)((()=>t[36]||(t[36]=[(0,a.eW)("Close")]))),_:2},1040)])),default:(0,a.k6)((()=>[(0,a.eW)((0,i.v_)(f.snackbarText)+" ",1)])),_:1},8,["modelValue","color"])])}var f=l(2977),v=l(4335),m=l(9061),h=l(5794),F={name:"ImageSecurity",data(){return{loading:!1,search:"",severityFilter:"all",severityOptions:[{text:"All Severities",value:"all"},{text:"Critical",value:"critical"},{text:"High",value:"high"},{text:"Medium",value:"medium"},{text:"Low",value:"low"}],headers:[{text:"Name",value:"name"},{text:"Severity",value:"severity"},{text:"Package",value:"package_name"},{text:"Current Version",value:"package_version"},{text:"Fixed Version",value:"fixed_version"},{text:"CVE ID",value:"cve_id"},{text:"References",value:"reference_urls"},{text:"Actions",value:"actions",sortable:!1}],detailsDialog:!1,selectedVulnerability:null,snackbar:!1,snackbarText:"",snackbarColor:"success"}},computed:{...(0,f.aH)("images",["currentScan"]),imageId(){return this.$route.params.id},scanId(){return parseInt(this.$route.params.scanId)},filteredVulnerabilities(){return this.currentScan&&this.currentScan.vulnerabilities?"all"===this.severityFilter?this.currentScan.vulnerabilities:this.currentScan.vulnerabilities.filter((e=>e.severity===this.severityFilter)):[]}},created(){this.fetchScanDetails()},methods:{...(0,f.i0)("images",["getImageScan"]),...(0,f.i0)({updateContext:"chat/updateContext"}),...(0,f.PY)({setActive:"chat/SET_ACTIVE"}),async fetchScanDetails(){this.loading=!0;try{await this.getImageScan({imageId:this.imageId,scanId:this.scanId})}catch(e){this.showError("Failed to fetch scan details: "+e.message)}finally{this.loading=!1}},goBack(){this.$router.push({name:"ImageDetail",params:{id:this.imageId}})},showVulnerabilityDetails(e){this.selectedVulnerability=e,this.detailsDialog=!0},formatDate(e){if(!e)return"Unknown";try{return(0,m.A)((0,h.A)(e),"MMM d, yyyy HH:mm")}catch(t){return e}},getScanStatusColor(e){switch(e){case"completed":return"success";case"running":return"info";case"failed":return"error";default:return"grey"}},getSeverityColor(e){switch(e){case"critical":return"red";case"high":return"orange";case"medium":return"yellow";case"low":return"blue";default:return"grey"}},showSuccess(e){this.snackbarText=e,this.snackbarColor="success",this.snackbar=!0},async resolveWithAI(e){try{const t=await v.A.post(`/api/chat/security/start-workflow?vulnerability_id=${e.cve_id||e.name}`);this.updateContext({currentPage:"security",currentImageId:this.imageId,vulnerability_id:e.cve_id||e.name,vulnerability_severity:e.severity,vulnerability_description:e.description,affected_package:e.package_name,current_version:e.package_version,fixed_version:e.fixed_version,cve_id:e.cve_id,workflow_id:t.data.message.context?.workflow_id}),this.setActive(!0),this.detailsDialog=!1,this.showSuccess("AI-assisted resolution workflow started. Check the chat sidebar.")}catch(t){console.error("Error starting security workflow:",t),this.showError("Failed to start AI resolution workflow.")}},showError(e){this.snackbarText=e,this.snackbarColor="error",this.snackbar=!0}}},g=l(6262);const y=(0,g.A)(F,[["render",_],["__scopeId","data-v-343d4d5c"]]);var p=y}}]);
//# sourceMappingURL=644.ec8d2530.js.map