"use strict";(self["webpackChunkdockerforge_web_ui"]=self["webpackChunkdockerforge_web_ui"]||[]).push([[992],{9992:function(e,l,t){t.r(l),t.d(l,{default:function(){return y}});var a=t(641),r=t(33);const i={class:"image-security"},s={class:"text-h4"},u={class:"text-h4"},n={class:"text-h4 black--text"},c={class:"text-h4"},d={key:0},o={key:1},k={key:0},b={key:1};function f(e,l,t,f,_,v){const m=(0,a.g2)("v-icon"),F=(0,a.g2)("v-spacer"),g=(0,a.g2)("v-btn"),h=(0,a.g2)("v-card-title"),y=(0,a.g2)("v-skeleton-loader"),p=(0,a.g2)("v-card-text"),x=(0,a.g2)("v-alert"),S=(0,a.g2)("v-list-item-title"),V=(0,a.g2)("v-list-item-subtitle"),w=(0,a.g2)("v-list-item-content"),W=(0,a.g2)("v-list-item"),C=(0,a.g2)("v-chip"),L=(0,a.g2)("v-list"),I=(0,a.g2)("v-col"),D=(0,a.g2)("v-row"),X=(0,a.g2)("v-card"),E=(0,a.g2)("v-divider"),A=(0,a.g2)("v-text-field"),N=(0,a.g2)("v-select"),T=(0,a.g2)("v-data-table"),H=(0,a.g2)("v-container"),M=(0,a.g2)("v-card-actions"),U=(0,a.g2)("v-dialog"),R=(0,a.g2)("v-snackbar");return(0,a.uX)(),(0,a.CE)("div",i,[(0,a.bF)(H,{fluid:""},{default:(0,a.k6)((()=>[(0,a.bF)(D,null,{default:(0,a.k6)((()=>[(0,a.bF)(I,{cols:"12"},{default:(0,a.k6)((()=>[(0,a.bF)(X,null,{default:(0,a.k6)((()=>[(0,a.bF)(h,{class:"headline"},{default:(0,a.k6)((()=>[(0,a.bF)(m,{large:"",left:""},{default:(0,a.k6)((()=>l[6]||(l[6]=[(0,a.eW)("mdi-shield-search")]))),_:1}),l[9]||(l[9]=(0,a.eW)(" Security Scan Results ")),(0,a.bF)(F),(0,a.bF)(g,{color:"primary",onClick:v.goBack},{default:(0,a.k6)((()=>[(0,a.bF)(m,{left:""},{default:(0,a.k6)((()=>l[7]||(l[7]=[(0,a.eW)("mdi-arrow-left")]))),_:1}),l[8]||(l[8]=(0,a.eW)(" Back to Image "))])),_:1},8,["onClick"])])),_:1}),_.loading?((0,a.uX)(),(0,a.Wv)(p,{key:0},{default:(0,a.k6)((()=>[(0,a.bF)(y,{type:"article"})])),_:1})):e.currentScan?((0,a.uX)(),(0,a.CE)(a.FK,{key:2},[(0,a.bF)(p,null,{default:(0,a.k6)((()=>[(0,a.bF)(D,null,{default:(0,a.k6)((()=>[(0,a.bF)(I,{cols:"12",md:"6"},{default:(0,a.k6)((()=>[(0,a.bF)(L,{dense:""},{default:(0,a.k6)((()=>[(0,a.bF)(W,null,{default:(0,a.k6)((()=>[(0,a.bF)(w,null,{default:(0,a.k6)((()=>[(0,a.bF)(S,null,{default:(0,a.k6)((()=>l[11]||(l[11]=[(0,a.eW)("Scan ID")]))),_:1}),(0,a.bF)(V,null,{default:(0,a.k6)((()=>[(0,a.eW)((0,r.v_)(e.currentScan.scan.id),1)])),_:1})])),_:1})])),_:1}),(0,a.bF)(W,null,{default:(0,a.k6)((()=>[(0,a.bF)(w,null,{default:(0,a.k6)((()=>[(0,a.bF)(S,null,{default:(0,a.k6)((()=>l[12]||(l[12]=[(0,a.eW)("Scan Type")]))),_:1}),(0,a.bF)(V,null,{default:(0,a.k6)((()=>[(0,a.eW)((0,r.v_)(e.currentScan.scan.scan_type),1)])),_:1})])),_:1})])),_:1}),(0,a.bF)(W,null,{default:(0,a.k6)((()=>[(0,a.bF)(w,null,{default:(0,a.k6)((()=>[(0,a.bF)(S,null,{default:(0,a.k6)((()=>l[13]||(l[13]=[(0,a.eW)("Status")]))),_:1}),(0,a.bF)(V,null,{default:(0,a.k6)((()=>[(0,a.bF)(C,{small:"",color:v.getScanStatusColor(e.currentScan.scan.status),"text-color":"white"},{default:(0,a.k6)((()=>[(0,a.eW)((0,r.v_)(e.currentScan.scan.status),1)])),_:1},8,["color"])])),_:1})])),_:1})])),_:1})])),_:1})])),_:1}),(0,a.bF)(I,{cols:"12",md:"6"},{default:(0,a.k6)((()=>[(0,a.bF)(L,{dense:""},{default:(0,a.k6)((()=>[(0,a.bF)(W,null,{default:(0,a.k6)((()=>[(0,a.bF)(w,null,{default:(0,a.k6)((()=>[(0,a.bF)(S,null,{default:(0,a.k6)((()=>l[14]||(l[14]=[(0,a.eW)("Started")]))),_:1}),(0,a.bF)(V,null,{default:(0,a.k6)((()=>[(0,a.eW)((0,r.v_)(v.formatDate(e.currentScan.scan.started_at)),1)])),_:1})])),_:1})])),_:1}),(0,a.bF)(W,null,{default:(0,a.k6)((()=>[(0,a.bF)(w,null,{default:(0,a.k6)((()=>[(0,a.bF)(S,null,{default:(0,a.k6)((()=>l[15]||(l[15]=[(0,a.eW)("Completed")]))),_:1}),(0,a.bF)(V,null,{default:(0,a.k6)((()=>[(0,a.eW)((0,r.v_)(v.formatDate(e.currentScan.scan.completed_at)),1)])),_:1})])),_:1})])),_:1}),(0,a.bF)(W,null,{default:(0,a.k6)((()=>[(0,a.bF)(w,null,{default:(0,a.k6)((()=>[(0,a.bF)(S,null,{default:(0,a.k6)((()=>l[16]||(l[16]=[(0,a.eW)("Total Vulnerabilities")]))),_:1}),(0,a.bF)(V,null,{default:(0,a.k6)((()=>[(0,a.eW)((0,r.v_)(e.currentScan.scan.vulnerabilities_count||0),1)])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})])),_:1}),(0,a.bF)(D,{class:"mt-4"},{default:(0,a.k6)((()=>[(0,a.bF)(I,{cols:"12"},{default:(0,a.k6)((()=>[(0,a.bF)(X,{outlined:""},{default:(0,a.k6)((()=>[(0,a.bF)(h,null,{default:(0,a.k6)((()=>l[17]||(l[17]=[(0,a.eW)("Vulnerability Summary")]))),_:1}),(0,a.bF)(p,null,{default:(0,a.k6)((()=>[(0,a.bF)(D,null,{default:(0,a.k6)((()=>[(0,a.bF)(I,{cols:"12",sm:"6",md:"3"},{default:(0,a.k6)((()=>[(0,a.bF)(X,{color:"red",dark:""},{default:(0,a.k6)((()=>[(0,a.bF)(p,{class:"text-center"},{default:(0,a.k6)((()=>[(0,a.Lk)("div",s,(0,r.v_)(e.currentScan.scan.critical_count||0),1),l[18]||(l[18]=(0,a.Lk)("div",null,"Critical",-1))])),_:1})])),_:1})])),_:1}),(0,a.bF)(I,{cols:"12",sm:"6",md:"3"},{default:(0,a.k6)((()=>[(0,a.bF)(X,{color:"orange",dark:""},{default:(0,a.k6)((()=>[(0,a.bF)(p,{class:"text-center"},{default:(0,a.k6)((()=>[(0,a.Lk)("div",u,(0,r.v_)(e.currentScan.scan.high_count||0),1),l[19]||(l[19]=(0,a.Lk)("div",null,"High",-1))])),_:1})])),_:1})])),_:1}),(0,a.bF)(I,{cols:"12",sm:"6",md:"3"},{default:(0,a.k6)((()=>[(0,a.bF)(X,{color:"yellow",dark:""},{default:(0,a.k6)((()=>[(0,a.bF)(p,{class:"text-center"},{default:(0,a.k6)((()=>[(0,a.Lk)("div",n,(0,r.v_)(e.currentScan.scan.medium_count||0),1),l[20]||(l[20]=(0,a.Lk)("div",{class:"black--text"},"Medium",-1))])),_:1})])),_:1})])),_:1}),(0,a.bF)(I,{cols:"12",sm:"6",md:"3"},{default:(0,a.k6)((()=>[(0,a.bF)(X,{color:"blue",dark:""},{default:(0,a.k6)((()=>[(0,a.bF)(p,{class:"text-center"},{default:(0,a.k6)((()=>[(0,a.Lk)("div",c,(0,r.v_)(e.currentScan.scan.low_count||0),1),l[21]||(l[21]=(0,a.Lk)("div",null,"Low",-1))])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})])),_:1}),(0,a.bF)(E),(0,a.bF)(h,null,{default:(0,a.k6)((()=>[l[22]||(l[22]=(0,a.eW)(" Vulnerabilities ")),(0,a.bF)(F),(0,a.bF)(A,{modelValue:_.search,"onUpdate:modelValue":l[0]||(l[0]=e=>_.search=e),"append-icon":"mdi-magnify",label:"Search","single-line":"","hide-details":"",class:"mx-4"},null,8,["modelValue"]),(0,a.bF)(N,{modelValue:_.severityFilter,"onUpdate:modelValue":l[1]||(l[1]=e=>_.severityFilter=e),items:_.severityOptions,label:"Severity","hide-details":"",class:"mx-4",style:{"max-width":"150px"}},null,8,["modelValue","items"])])),_:1}),(0,a.bF)(T,{headers:_.headers,items:v.filteredVulnerabilities,search:_.search,"items-per-page":10,"footer-props":{"items-per-page-options":[5,10,15,20,50]},class:"elevation-1"},{"item.severity":(0,a.k6)((({item:e})=>[(0,a.bF)(C,{small:"",color:v.getSeverityColor(e.severity),"text-color":"medium"===e.severity?"black":"white"},{default:(0,a.k6)((()=>[(0,a.eW)((0,r.v_)(e.severity),1)])),_:2},1032,["color","text-color"])])),"item.reference_urls":(0,a.k6)((({item:e})=>[e.reference_urls&&e.reference_urls.length>0?((0,a.uX)(),(0,a.CE)("div",d,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(e.reference_urls,((e,t)=>((0,a.uX)(),(0,a.Wv)(g,{key:t,"x-small":"",text:"",color:"primary",href:e,target:"_blank",class:"mr-1"},{default:(0,a.k6)((()=>[(0,a.bF)(m,{"x-small":"",left:""},{default:(0,a.k6)((()=>l[23]||(l[23]=[(0,a.eW)("mdi-open-in-new")]))),_:1}),(0,a.eW)(" Link "+(0,r.v_)(t+1),1)])),_:2},1032,["href"])))),128))])):((0,a.uX)(),(0,a.CE)("span",o,"-"))])),"item.actions":(0,a.k6)((({item:e})=>[(0,a.bF)(g,{icon:"",small:"",onClick:l=>v.showVulnerabilityDetails(e)},{default:(0,a.k6)((()=>[(0,a.bF)(m,{small:""},{default:(0,a.k6)((()=>l[24]||(l[24]=[(0,a.eW)("mdi-information-outline")]))),_:1})])),_:2},1032,["onClick"])])),_:1},8,["headers","items","search"])],64)):((0,a.uX)(),(0,a.Wv)(p,{key:1},{default:(0,a.k6)((()=>[(0,a.bF)(x,{type:"error"},{default:(0,a.k6)((()=>l[10]||(l[10]=[(0,a.eW)("Scan not found")]))),_:1})])),_:1}))])),_:1})])),_:1})])),_:1})])),_:1}),(0,a.bF)(U,{modelValue:_.detailsDialog,"onUpdate:modelValue":l[3]||(l[3]=e=>_.detailsDialog=e),"max-width":"700px"},{default:(0,a.k6)((()=>[_.selectedVulnerability?((0,a.uX)(),(0,a.Wv)(X,{key:0},{default:(0,a.k6)((()=>[(0,a.bF)(h,{class:"headline"},{default:(0,a.k6)((()=>[(0,a.bF)(C,{small:"",color:v.getSeverityColor(_.selectedVulnerability.severity),"text-color":"medium"===_.selectedVulnerability.severity?"black":"white",class:"mr-2"},{default:(0,a.k6)((()=>[(0,a.eW)((0,r.v_)(_.selectedVulnerability.severity),1)])),_:1},8,["color","text-color"]),(0,a.eW)(" "+(0,r.v_)(_.selectedVulnerability.name),1)])),_:1}),(0,a.bF)(p,null,{default:(0,a.k6)((()=>[(0,a.bF)(D,null,{default:(0,a.k6)((()=>[(0,a.bF)(I,{cols:"12"},{default:(0,a.k6)((()=>[l[25]||(l[25]=(0,a.Lk)("div",{class:"subtitle-1 font-weight-bold"},"Description",-1)),(0,a.Lk)("div",null,(0,r.v_)(_.selectedVulnerability.description),1)])),_:1}),(0,a.bF)(I,{cols:"12",sm:"6"},{default:(0,a.k6)((()=>[l[26]||(l[26]=(0,a.Lk)("div",{class:"subtitle-1 font-weight-bold"},"Package",-1)),(0,a.Lk)("div",null,(0,r.v_)(_.selectedVulnerability.package_name||"N/A"),1)])),_:1}),(0,a.bF)(I,{cols:"12",sm:"6"},{default:(0,a.k6)((()=>[l[27]||(l[27]=(0,a.Lk)("div",{class:"subtitle-1 font-weight-bold"},"Current Version",-1)),(0,a.Lk)("div",null,(0,r.v_)(_.selectedVulnerability.package_version||"N/A"),1)])),_:1}),(0,a.bF)(I,{cols:"12",sm:"6"},{default:(0,a.k6)((()=>[l[28]||(l[28]=(0,a.Lk)("div",{class:"subtitle-1 font-weight-bold"},"Fixed Version",-1)),(0,a.Lk)("div",null,(0,r.v_)(_.selectedVulnerability.fixed_version||"N/A"),1)])),_:1}),(0,a.bF)(I,{cols:"12",sm:"6"},{default:(0,a.k6)((()=>[l[29]||(l[29]=(0,a.Lk)("div",{class:"subtitle-1 font-weight-bold"},"CVE ID",-1)),(0,a.Lk)("div",null,(0,r.v_)(_.selectedVulnerability.cve_id||"N/A"),1)])),_:1}),(0,a.bF)(I,{cols:"12"},{default:(0,a.k6)((()=>[l[31]||(l[31]=(0,a.Lk)("div",{class:"subtitle-1 font-weight-bold"},"References",-1)),_.selectedVulnerability.reference_urls&&_.selectedVulnerability.reference_urls.length>0?((0,a.uX)(),(0,a.CE)("div",k,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(_.selectedVulnerability.reference_urls,((e,t)=>((0,a.uX)(),(0,a.Wv)(g,{key:t,small:"",text:"",color:"primary",href:e,target:"_blank",class:"mr-1 mb-1"},{default:(0,a.k6)((()=>[(0,a.bF)(m,{small:"",left:""},{default:(0,a.k6)((()=>l[30]||(l[30]=[(0,a.eW)("mdi-open-in-new")]))),_:1}),(0,a.eW)(" Reference "+(0,r.v_)(t+1),1)])),_:2},1032,["href"])))),128))])):((0,a.uX)(),(0,a.CE)("div",b,"No references available"))])),_:1})])),_:1})])),_:1}),(0,a.bF)(M,null,{default:(0,a.k6)((()=>[(0,a.bF)(F),(0,a.bF)(g,{color:"primary",text:"",onClick:l[2]||(l[2]=e=>_.detailsDialog=!1)},{default:(0,a.k6)((()=>l[32]||(l[32]=[(0,a.eW)("Close")]))),_:1})])),_:1})])),_:1})):(0,a.Q3)("",!0)])),_:1},8,["modelValue"]),(0,a.bF)(R,{modelValue:_.snackbar,"onUpdate:modelValue":l[5]||(l[5]=e=>_.snackbar=e),color:_.snackbarColor,timeout:3e3},{action:(0,a.k6)((({attrs:e})=>[(0,a.bF)(g,(0,a.v6)({text:""},e,{onClick:l[4]||(l[4]=e=>_.snackbar=!1)}),{default:(0,a.k6)((()=>l[33]||(l[33]=[(0,a.eW)("Close")]))),_:2},1040)])),default:(0,a.k6)((()=>[(0,a.eW)((0,r.v_)(_.snackbarText)+" ",1)])),_:1},8,["modelValue","color"])])}var _=t(2977),v=t(9061),m=t(5794),F={name:"ImageSecurity",data(){return{loading:!1,search:"",severityFilter:"all",severityOptions:[{text:"All Severities",value:"all"},{text:"Critical",value:"critical"},{text:"High",value:"high"},{text:"Medium",value:"medium"},{text:"Low",value:"low"}],headers:[{text:"Name",value:"name"},{text:"Severity",value:"severity"},{text:"Package",value:"package_name"},{text:"Current Version",value:"package_version"},{text:"Fixed Version",value:"fixed_version"},{text:"CVE ID",value:"cve_id"},{text:"References",value:"reference_urls"},{text:"Actions",value:"actions",sortable:!1}],detailsDialog:!1,selectedVulnerability:null,snackbar:!1,snackbarText:"",snackbarColor:"success"}},computed:{...(0,_.aH)("images",["currentScan"]),imageId(){return this.$route.params.id},scanId(){return parseInt(this.$route.params.scanId)},filteredVulnerabilities(){return this.currentScan&&this.currentScan.vulnerabilities?"all"===this.severityFilter?this.currentScan.vulnerabilities:this.currentScan.vulnerabilities.filter((e=>e.severity===this.severityFilter)):[]}},created(){this.fetchScanDetails()},methods:{...(0,_.i0)("images",["getImageScan"]),async fetchScanDetails(){this.loading=!0;try{await this.getImageScan({imageId:this.imageId,scanId:this.scanId})}catch(e){this.showError("Failed to fetch scan details: "+e.message)}finally{this.loading=!1}},goBack(){this.$router.push({name:"ImageDetail",params:{id:this.imageId}})},showVulnerabilityDetails(e){this.selectedVulnerability=e,this.detailsDialog=!0},formatDate(e){if(!e)return"Unknown";try{return(0,v.A)((0,m.A)(e),"MMM d, yyyy HH:mm")}catch(l){return e}},getScanStatusColor(e){switch(e){case"completed":return"success";case"running":return"info";case"failed":return"error";default:return"grey"}},getSeverityColor(e){switch(e){case"critical":return"red";case"high":return"orange";case"medium":return"yellow";case"low":return"blue";default:return"grey"}},showSuccess(e){this.snackbarText=e,this.snackbarColor="success",this.snackbar=!0},showError(e){this.snackbarText=e,this.snackbarColor="error",this.snackbar=!0}}},g=t(6262);const h=(0,g.A)(F,[["render",f],["__scopeId","data-v-56569535"]]);var y=h}}]);