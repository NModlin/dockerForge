"use strict";(self["webpackChunkdockerforge_web_ui"]=self["webpackChunkdockerforge_web_ui"]||[]).push([[466],{4466:function(e,t,r){r.r(t),r.d(t,{default:function(){return S}});var i=r(641),a=r(33);const s={class:"security-dashboard"},c={key:0,class:"d-flex justify-center align-center my-5"},o={class:"text-h4"},l={class:"mt-4"},n={class:"text-h4 red--text"},u={class:"text-h4 orange--text"},d={class:"text-h4 blue--text"},m={class:"text-h4"},_={class:"text-h4"},p={key:3},g={class:"d-flex align-center"},f={key:0};function k(e,t,r,k,h,y){const b=(0,i.g2)("v-progress-circular"),v=(0,i.g2)("v-alert"),S=(0,i.g2)("v-icon"),x=(0,i.g2)("v-card-title"),F=(0,i.g2)("v-chip"),w=(0,i.g2)("v-card-text"),C=(0,i.g2)("v-card"),L=(0,i.g2)("v-col"),W=(0,i.g2)("v-row"),R=(0,i.g2)("v-btn"),D=(0,i.g2)("v-progress-linear"),X=(0,i.g2)("router-link"),$=(0,i.g2)("v-data-table"),A=(0,i.g2)("v-expansion-panel-header"),E=(0,i.g2)("v-expansion-panel-content"),T=(0,i.g2)("v-expansion-panel"),I=(0,i.g2)("v-expansion-panels");return(0,i.uX)(),(0,i.CE)("div",s,[t[20]||(t[20]=(0,i.Lk)("h1",{class:"text-h4 mb-4"},"Security Dashboard",-1)),h.loading?((0,i.uX)(),(0,i.CE)("div",c,[(0,i.bF)(b,{indeterminate:"",color:"primary"})])):h.error?((0,i.uX)(),(0,i.Wv)(v,{key:1,type:"error",class:"mb-4"},{default:(0,i.k6)((()=>[(0,i.eW)((0,a.v_)(h.error),1)])),_:1})):((0,i.uX)(),(0,i.CE)(i.FK,{key:2},[(0,i.bF)(W,null,{default:(0,i.k6)((()=>[(0,i.bF)(L,{cols:"12",md:"4"},{default:(0,i.k6)((()=>[(0,i.bF)(C,{class:"mb-4"},{default:(0,i.k6)((()=>[(0,i.bF)(x,{class:"headline"},{default:(0,i.k6)((()=>[(0,i.bF)(S,{left:"",color:y.getSecurityScoreColor(h.securityScore)},{default:(0,i.k6)((()=>t[0]||(t[0]=[(0,i.eW)(" mdi-shield ")]))),_:1},8,["color"]),t[1]||(t[1]=(0,i.eW)(" Security Score "))])),_:1}),(0,i.bF)(w,{class:"text-center"},{default:(0,i.k6)((()=>[(0,i.bF)(b,{rotate:-90,size:150,width:15,value:h.securityScore,color:y.getSecurityScoreColor(h.securityScore)},{default:(0,i.k6)((()=>[(0,i.Lk)("span",o,(0,a.v_)(h.securityScore),1)])),_:1},8,["value","color"]),(0,i.Lk)("div",l,[(0,i.bF)(F,{color:y.getSecurityScoreColor(h.securityScore),"text-color":"white"},{default:(0,i.k6)((()=>[(0,i.eW)((0,a.v_)(y.getSecurityScoreLabel(h.securityScore)),1)])),_:1},8,["color"])])])),_:1})])),_:1})])),_:1}),(0,i.bF)(L,{cols:"12",md:"4"},{default:(0,i.k6)((()=>[(0,i.bF)(C,{class:"mb-4"},{default:(0,i.k6)((()=>[(0,i.bF)(x,{class:"headline"},{default:(0,i.k6)((()=>[(0,i.bF)(S,{left:"",color:"error"},{default:(0,i.k6)((()=>t[2]||(t[2]=[(0,i.eW)("mdi-alert")]))),_:1}),t[3]||(t[3]=(0,i.eW)(" Vulnerabilities "))])),_:1}),(0,i.bF)(w,null,{default:(0,i.k6)((()=>[(0,i.bF)(W,null,{default:(0,i.k6)((()=>[(0,i.bF)(L,{cols:"4",class:"text-center"},{default:(0,i.k6)((()=>[(0,i.Lk)("div",n,(0,a.v_)(h.vulnerabilityCounts.critical),1),t[4]||(t[4]=(0,i.Lk)("div",{class:"text-subtitle-1"},"Critical",-1))])),_:1}),(0,i.bF)(L,{cols:"4",class:"text-center"},{default:(0,i.k6)((()=>[(0,i.Lk)("div",u,(0,a.v_)(h.vulnerabilityCounts.high),1),t[5]||(t[5]=(0,i.Lk)("div",{class:"text-subtitle-1"},"High",-1))])),_:1}),(0,i.bF)(L,{cols:"4",class:"text-center"},{default:(0,i.k6)((()=>[(0,i.Lk)("div",d,(0,a.v_)(h.vulnerabilityCounts.medium+h.vulnerabilityCounts.low),1),t[6]||(t[6]=(0,i.Lk)("div",{class:"text-subtitle-1"},"Other",-1))])),_:1})])),_:1}),(0,i.bF)(R,{color:"primary",block:"",class:"mt-4",to:"/security/vulnerabilities"},{default:(0,i.k6)((()=>t[7]||(t[7]=[(0,i.eW)(" View All Vulnerabilities ")]))),_:1})])),_:1})])),_:1})])),_:1}),(0,i.bF)(L,{cols:"12",md:"4"},{default:(0,i.k6)((()=>[(0,i.bF)(C,{class:"mb-4"},{default:(0,i.k6)((()=>[(0,i.bF)(x,{class:"headline"},{default:(0,i.k6)((()=>[(0,i.bF)(S,{left:"",color:"warning"},{default:(0,i.k6)((()=>t[8]||(t[8]=[(0,i.eW)("mdi-check-decagram")]))),_:1}),t[9]||(t[9]=(0,i.eW)(" Compliance "))])),_:1}),(0,i.bF)(w,null,{default:(0,i.k6)((()=>[(0,i.bF)(W,null,{default:(0,i.k6)((()=>[(0,i.bF)(L,{cols:"6",class:"text-center"},{default:(0,i.k6)((()=>[(0,i.Lk)("div",m,(0,a.v_)(h.complianceStats.passed),1),t[10]||(t[10]=(0,i.Lk)("div",{class:"text-subtitle-1 success--text"},"Passed",-1))])),_:1}),(0,i.bF)(L,{cols:"6",class:"text-center"},{default:(0,i.k6)((()=>[(0,i.Lk)("div",_,(0,a.v_)(h.complianceStats.failed),1),t[11]||(t[11]=(0,i.Lk)("div",{class:"text-subtitle-1 error--text"},"Failed",-1))])),_:1})])),_:1}),(0,i.bF)(D,{value:h.complianceStats.passed/(h.complianceStats.passed+h.complianceStats.failed)*100,color:"success",height:"20",class:"mt-2"},{default:(0,i.k6)((()=>[(0,i.eW)((0,a.v_)(Math.round(h.complianceStats.passed/(h.complianceStats.passed+h.complianceStats.failed)*100))+"% ",1)])),_:1},8,["value"]),(0,i.bF)(R,{color:"primary",block:"",class:"mt-4",to:"/security/compliance"},{default:(0,i.k6)((()=>t[12]||(t[12]=[(0,i.eW)(" View Compliance Report ")]))),_:1})])),_:1})])),_:1})])),_:1})])),_:1}),t[18]||(t[18]=(0,i.Lk)("h2",{class:"text-h5 mb-3"},"Recent Security Scans",-1)),(0,i.bF)(C,{class:"mb-4"},{default:(0,i.k6)((()=>[(0,i.bF)($,{headers:h.scanHeaders,items:h.recentScans,"items-per-page":5,class:"elevation-1"},{"item.resource":(0,i.k6)((({item:e})=>[(0,i.bF)(X,{to:y.getResourceLink(e),class:"text-decoration-none"},{default:(0,i.k6)((()=>[(0,i.eW)((0,a.v_)(e.resource_name),1)])),_:2},1032,["to"]),(0,i.bF)(F,{"x-small":"",class:"ml-2",color:y.getResourceTypeColor(e.resource_type)},{default:(0,i.k6)((()=>[(0,i.eW)((0,a.v_)(e.resource_type),1)])),_:2},1032,["color"])])),"item.status":(0,i.k6)((({item:e})=>[(0,i.bF)(F,{color:y.getScanStatusColor(e.status),"text-color":"white",small:""},{default:(0,i.k6)((()=>[(0,i.eW)((0,a.v_)(e.status),1)])),_:2},1032,["color"])])),"item.findings":(0,i.k6)((({item:e})=>[e.critical_count>0?((0,i.uX)(),(0,i.Wv)(F,{key:0,color:"error","x-small":"",class:"mr-1"},{default:(0,i.k6)((()=>[(0,i.eW)((0,a.v_)(e.critical_count)+" Critical ",1)])),_:2},1024)):(0,i.Q3)("",!0),e.high_count>0?((0,i.uX)(),(0,i.Wv)(F,{key:1,color:"warning","x-small":"",class:"mr-1"},{default:(0,i.k6)((()=>[(0,i.eW)((0,a.v_)(e.high_count)+" High ",1)])),_:2},1024)):(0,i.Q3)("",!0),e.medium_count>0?((0,i.uX)(),(0,i.Wv)(F,{key:2,color:"info","x-small":"",class:"mr-1"},{default:(0,i.k6)((()=>[(0,i.eW)((0,a.v_)(e.medium_count)+" Medium ",1)])),_:2},1024)):(0,i.Q3)("",!0),0===e.critical_count&&0===e.high_count&&0===e.medium_count?((0,i.uX)(),(0,i.CE)("span",p," No significant findings ")):(0,i.Q3)("",!0)])),"item.scan_date":(0,i.k6)((({item:e})=>[(0,i.eW)((0,a.v_)(y.formatDate(e.scan_date)),1)])),"item.actions":(0,i.k6)((({item:e})=>[(0,i.bF)(R,{icon:"",small:"",to:y.getScanDetailsLink(e),title:"View Details"},{default:(0,i.k6)((()=>[(0,i.bF)(S,{small:""},{default:(0,i.k6)((()=>t[13]||(t[13]=[(0,i.eW)("mdi-eye")]))),_:1})])),_:2},1032,["to"]),(0,i.bF)(R,{icon:"",small:"",onClick:t=>y.runNewScan(e),title:"Run New Scan",disabled:"in-progress"===e.status},{default:(0,i.k6)((()=>[(0,i.bF)(S,{small:""},{default:(0,i.k6)((()=>t[14]||(t[14]=[(0,i.eW)("mdi-refresh")]))),_:1})])),_:2},1032,["onClick","disabled"])])),_:1},8,["headers","items"])])),_:1}),t[19]||(t[19]=(0,i.Lk)("h2",{class:"text-h5 mb-3"},"Security Recommendations",-1)),(0,i.bF)(W,null,{default:(0,i.k6)((()=>[(0,i.bF)(L,{cols:"12"},{default:(0,i.k6)((()=>[(0,i.bF)(I,null,{default:(0,i.k6)((()=>[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(h.recommendations,((e,r)=>((0,i.uX)(),(0,i.Wv)(T,{key:r},{default:(0,i.k6)((()=>[(0,i.bF)(A,null,{default:(0,i.k6)((()=>[(0,i.Lk)("div",g,[(0,i.bF)(S,{color:y.getRecommendationPriorityColor(e.priority),class:"mr-2"},{default:(0,i.k6)((()=>t[15]||(t[15]=[(0,i.eW)(" mdi-alert-circle ")]))),_:2},1032,["color"]),(0,i.Lk)("span",null,(0,a.v_)(e.title),1),(0,i.bF)(F,{class:"ml-2","x-small":"",color:y.getRecommendationPriorityColor(e.priority),"text-color":"white"},{default:(0,i.k6)((()=>[(0,i.eW)((0,a.v_)(e.priority),1)])),_:2},1032,["color"])])])),_:2},1024),(0,i.bF)(E,null,{default:(0,i.k6)((()=>[(0,i.Lk)("p",null,(0,a.v_)(e.description),1),e.affected_resources.length>0?((0,i.uX)(),(0,i.CE)("div",f,[t[16]||(t[16]=(0,i.Lk)("strong",null,"Affected Resources:",-1)),(0,i.Lk)("ul",null,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(e.affected_resources,((e,t)=>((0,i.uX)(),(0,i.CE)("li",{key:t},(0,a.v_)(e.name)+" ("+(0,a.v_)(e.type)+") ",1)))),128))])])):(0,i.Q3)("",!0),(0,i.bF)(R,{color:"primary",text:"",class:"mt-2",onClick:t=>y.applyRecommendation(e)},{default:(0,i.k6)((()=>t[17]||(t[17]=[(0,i.eW)(" Apply Recommendation ")]))),_:2},1032,["onClick"])])),_:2},1024)])),_:2},1024)))),128))])),_:1})])),_:1})])),_:1})],64))])}var h=r(2977),y={name:"SecurityDashboard",data(){return{loading:!0,error:null,securityScore:0,vulnerabilityCounts:{critical:0,high:0,medium:0,low:0},complianceStats:{passed:0,failed:0},scanHeaders:[{text:"Resource",value:"resource",sortable:!0},{text:"Status",value:"status",sortable:!0},{text:"Findings",value:"findings",sortable:!1},{text:"Scan Date",value:"scan_date",sortable:!0},{text:"Actions",value:"actions",sortable:!1,align:"center"}],recentScans:[],recommendations:[]}},computed:{...(0,h.L8)({isAuthenticated:"auth/isAuthenticated",token:"auth/token"})},created(){this.fetchSecurityData()},methods:{async fetchSecurityData(){this.loading=!0,this.error=null;try{setTimeout((()=>{this.securityScore=78,this.vulnerabilityCounts={critical:2,high:5,medium:12,low:23},this.complianceStats={passed:42,failed:8},this.recentScans=[{id:"s1",resource_type:"image",resource_id:"i1",resource_name:"nginx:latest",status:"completed",critical_count:0,high_count:2,medium_count:5,scan_date:"2025-03-16T10:00:00Z"},{id:"s2",resource_type:"image",resource_id:"i2",resource_name:"postgres:13",status:"completed",critical_count:1,high_count:3,medium_count:7,scan_date:"2025-03-16T09:30:00Z"},{id:"s3",resource_type:"container",resource_id:"c1",resource_name:"web-server",status:"completed",critical_count:0,high_count:0,medium_count:0,scan_date:"2025-03-16T09:00:00Z"},{id:"s4",resource_type:"image",resource_id:"i3",resource_name:"node:14-alpine",status:"in-progress",critical_count:0,high_count:0,medium_count:0,scan_date:"2025-03-16T08:45:00Z"},{id:"s5",resource_type:"container",resource_id:"c3",resource_name:"database",status:"failed",critical_count:0,high_count:0,medium_count:0,scan_date:"2025-03-16T08:30:00Z"}],this.recommendations=[{id:"r1",title:"Update nginx image to fix critical vulnerabilities",description:"The current nginx image has 2 critical vulnerabilities that can be fixed by updating to the latest version.",priority:"high",affected_resources:[{name:"nginx:latest",type:"image"},{name:"web-server",type:"container"}]},{id:"r2",title:"Enable user namespace remapping",description:"User namespace remapping provides an additional layer of security by mapping container user IDs to a different range on the host.",priority:"medium",affected_resources:[]},{id:"r3",title:"Apply security policy to restrict privileged containers",description:"Privileged containers have access to all host devices and can pose a security risk. Apply a security policy to restrict their usage.",priority:"high",affected_resources:[{name:"database",type:"container"}]},{id:"r4",title:"Configure network policies to restrict container communication",description:"Implement network policies to restrict communication between containers and limit exposure to potential attacks.",priority:"medium",affected_resources:[]},{id:"r5",title:"Enable content trust for image verification",description:"Content trust ensures that the images you pull are signed and verified, reducing the risk of using compromised images.",priority:"medium",affected_resources:[]}],this.loading=!1}),1e3)}catch(e){this.error="Failed to load security data. Please try again.",this.loading=!1}},formatDate(e){const t=new Date(e);return t.toLocaleString()},getSecurityScoreColor(e){return e>=90?"success":e>=70?"warning":"error"},getSecurityScoreLabel(e){return e>=90?"Good":e>=70?"Needs Improvement":"At Risk"},getScanStatusColor(e){switch(e){case"completed":return"success";case"in-progress":return"info";case"failed":return"error";default:return"grey"}},getResourceTypeColor(e){switch(e){case"image":return"primary";case"container":return"success";case"volume":return"warning";case"network":return"info";default:return"grey"}},getRecommendationPriorityColor(e){switch(e){case"critical":return"error";case"high":return"deep-orange";case"medium":return"warning";case"low":return"info";default:return"grey"}},getResourceLink(e){switch(e.resource_type){case"image":return`/images/${e.resource_id}`;case"container":return`/containers/${e.resource_id}`;case"volume":return`/volumes/${e.resource_id}`;case"network":return`/networks/${e.resource_id}`;default:return"#"}},getScanDetailsLink(e){return"image"===e.resource_type?`/images/${e.resource_id}/security/${e.id}`:`/security/scans/${e.id}`},runNewScan(e){this.$set(e,"status","in-progress"),this.$set(e,"scan_date",(new Date).toISOString()),setTimeout((()=>{this.$set(e,"status","completed")}),3e3)},applyRecommendation(e){this.$emit("show-notification",{type:"success",message:`Applied recommendation: ${e.title}`}),this.recommendations=this.recommendations.filter((t=>t.id!==e.id)),this.securityScore+=5,this.securityScore>100&&(this.securityScore=100)}}},b=r(6262);const v=(0,b.A)(y,[["render",k],["__scopeId","data-v-6cb85251"]]);var S=v}}]);